(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1f33"],{"05uX":function(t,e,a){"use strict";var n=a("DfgK");a.n(n).a},Bqnx:function(t,e,a){},DXyi:function(t,e,a){"use strict";var n=a("4R65"),r=a.n(n);a("INa4"),a("bMVF"),a("5j9R"),a("XJYT"),a("YZxl");r.a.Icon.Default.imagePath="/";var i={props:["pageImagePath","coordinate"],data:function(){return{map:null,map_config:{zoom:2,center:[30,3],minZoom:1,maxZoom:18},point:[],drawItem:{type:[],latlngs:[]}}},methods:{open:function(){var t=this;this.$alert("这是一段内容","标题名称",{confirmButtonText:"确定",callback:function(e){t.$message({type:"info",message:"action: "+e})}})},savePoints:function(t){var e=this;console.log(t.layerType),this.drawItem.type=t.layerType,t.layer._latlngs[0].forEach(function(t,a){e.drawItem.latlngs[a]={lat:t.lat,lng:t.lng}}),this.$emit("draw",this.drawItem)},editPoints:function(t){var e=this;t._latlngs[0].forEach(function(t,a){e.drawItem.latlngs[a]={lat:t.lat,lng:t.lng}}),this.$emit("draw",this.drawItem)},deletePoints:function(){this.drawItem={type:[],latlngs:[]},this.$emit("draw",this.drawItem)},getColorByRandom:function(){var t=["#ffbf26","#ff6438","#2cfff5","#c556ff","#ff4c5f","#0bed07","#4d596c","#8AC007","#ccb324","#FFAD5C","#72ff71","#ff78af","#93adff","#ffb3cf"];return t[Math.floor(Math.random()*t.length)]},showPoint:function(t,e){switch(t.type){case"polygon":new r.a.Polygon(t.latlngs,{weight:1,color:this.getColorByRandom()}).addTo(e);break;case"rectangle":new r.a.Rectangle(t.latlngs,{weight:1,color:this.getColorByRandom()}).addTo(e)}},getDrawItem:function(){this.drawItem=JSON.parse(this.coordinate)}},mounted:function(){void 0!==this.coordinate&&""!==this.coordinate&&null!==this.coordinate&&this.getDrawItem();var t=this;this.map=r.a.map("leaflet-map",{editable:!0,crs:r.a.CRS.Simple,zoom:1,maxZoom:5,minZoom:-3.5,center:[210,300]});var e=this.map.unproject([0,0],this.map.getMinZoom()-5),n=this.map.unproject([210,300],this.map.getMaxZoom()-5),i=new r.a.LatLngBounds(e,n);r.a.Icon.Default.mergeOptions({iconRetinaUrl:a("WE1v"),iconUrl:a("Y5fm"),shadowUrl:a("4rkx")});var o=this.pageImagePath;r.a.imageOverlay(o,i).addTo(this.map),this.map.setMaxBounds(i),this.map.fitBounds(i);var s=new r.a.FeatureGroup;this.map.addLayer(s);r.a.Icon.extend({options:{shadowUrl:null,iconAnchor:new r.a.Point(12,12),iconSize:new r.a.Point(24,24),iconUrl:"link/to/image.png"}});var l=new r.a.FeatureGroup;this.map.addLayer(l);var c={position:"topright",draw:{polyline:!1,polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},circle:!1,rectangle:{shapeOptions:{clickable:!1}},circlemarker:!1,marker:!1},edit:{featureGroup:l,edit:!0,remove:!0}},u=new r.a.Control.Draw(c);this.map.addControl(u),this.map.on(r.a.Draw.Event.CREATED,function(e){console.log(e),t.savePoints(e),e.layer.addTo(l)}),""!=this.drawItem.type&&this.showPoint(this.drawItem,l),this.map.on(r.a.Draw.Event.EDITED,function(e){e.layers.eachLayer(function(e){t.editPoints(e)})}),this.map.on(r.a.Draw.Event.DELETED,function(e){t.deletePoints()})}},o=(a("sMTx"),a("KHd+")),s=Object(o.a)(i,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{ref:"leaflet",attrs:{id:"leaflet-map"}})])},[],!1,null,null,null);s.options.__file="index.vue";e.a=s.exports},DfgK:function(t,e,a){},JCNI:function(t,e,a){"use strict";a.d(e,"i",function(){return c}),a.d(e,"k",function(){return u}),a.d(e,"a",function(){return d}),a.d(e,"f",function(){return h}),a.d(e,"c",function(){return m}),a.d(e,"m",function(){return p}),a.d(e,"h",function(){return f}),a.d(e,"b",function(){return g}),a.d(e,"j",function(){return v}),a.d(e,"l",function(){return b}),a.d(e,"g",function(){return w}),a.d(e,"d",function(){return k}),a.d(e,"e",function(){return y});var n=a("gDS+"),r=a.n(n),i=a("vDqi"),o=a.n(i),s=a("Q2AE"),l=function(t){return JSON.parse(r()(t))};function c(t,e){return t=l(t),o()({method:"get",url:"/page/articles",params:{id:e},headers:{"Content-type":"application/json",Authorization:"bearer "+s.a.state.user.token}})}function u(t){return o()({method:"get",url:"/recommend/list/"+t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function d(t){return o()({method:"post",url:"/article/add/",data:t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function h(t){return o()({method:"delete",url:"/article/",params:{id:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}function m(t,e){return o()({method:"put",url:"/recommend/add/"+e,params:{id:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}function p(t){return o()({method:"post",url:"/recommend/saveList",data:t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function f(t){return o()({method:"delete",url:"/recommend",params:{id:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}function g(t){return o()({method:"post",url:"/catalog/add",data:t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function v(){return o()({method:"get",url:"/catalog/list/",headers:{Authorization:"bearer "+s.a.state.user.token}})}function b(t){return o()({method:"post",url:"/catalog/saveList",data:t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function w(t){return o()({method:"delete",url:"/catalog",params:{id:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}function k(t){return t=l(t),o()({method:"get",url:"/article/list",params:t,headers:{"Content-type":"application/json",Authorization:"bearer "+s.a.state.user.token}})}function y(t){return o()({method:"post",url:"/article/check",data:t,headers:{"Content-type":"application/json",Authorization:"bearer "+s.a.state.user.token}})}},QmMk:function(t,e,a){"use strict";var n=a("cdQt");a.n(n).a},RaKr:function(t,e,a){"use strict";a.d(e,"d",function(){return c}),a.d(e,"a",function(){return u}),a.d(e,"b",function(){return d}),a.d(e,"c",function(){return h});var n=a("gDS+"),r=a.n(n),i=a("vDqi"),o=a.n(i),s=a("Q2AE"),l=function(t){return JSON.parse(r()(t))};function c(t,e){return t=l(t),o()({method:"get",url:"/paper/pages",params:{id:e},headers:{"Content-type":"application/json",Authorization:"bearer "+s.a.state.user.token}})}function u(t){return o()({method:"post",url:"/page/add",data:t,headers:{Authorization:"bearer "+s.a.state.user.token}})}function d(t){return o()({method:"delete",url:"/page/",params:{id:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}function h(t){return o()({method:"GET",url:"/page/getImagePath",params:{pageId:t},headers:{Authorization:"bearer "+s.a.state.user.token}})}},UKXy:function(t,e,a){"use strict";a.r(e);var n,r=a("YEIV"),i=a.n(r),o=a("gDS+"),s=a.n(o),l=a("4d7F"),c=a.n(l),u=a("Q2AE"),d=a("JCNI"),h=a("RaKr"),m=a("s+lJ"),p=a("DXyi"),f=a("a4+v"),g=a("vDqi"),v=a.n(g),b=(n={name:"",components:{VueEditor:m.VueEditor,Leaflet:p.a,MongolianInput:f.a},computed:{headers:function(){return{Authorization:"bearer "+u.a.state.user.token}}},props:{article:{required:!0}},data:function(){return{verified:1==this.article.state,recommend:this.article.recommend,pageImagePath:this.$store.state.article.pageImagePath,coordinateObject:{type:"",latlngs:[]},catalog:{id:null==this.article.catalog?"":this.article.catalog.id},catalogOptions:[],recommendOptions:[{value:0,label:"不推荐"},{value:1,label:"文本推荐"}],recommendImage:{value:2,label:"图文推荐"},inputSpan:2,editorSpan:20,leafletSpan:15}}},i()(n,"computed",{imagePathCount:function(){var t=this.article.content.match(/<img.*?(?:>|\/>)/gi);return null==t?0:t.length}}),i()(n,"methods",{audited:function(){this.verified?this.article.state=1:this.article.state=0},recommendArticle:function(){0!=this.recommend?Object(d.c)(this.article.id,this.recommend).then(function(t){}):Object(d.h)(this.article.id).then(function(t){})},cancelEdit:function(){this.$router.go(-1)},handleInput:function(){this.$refs.title.handleInput(),this.$refs.author.handleInput(),this.$refs.subTitle.handleInput()},handleCatalog:function(){this.article.catalog=this.catalog,""==this.article.catalog.id&&delete this.article.catalog},handleAdd:function(){var t=this;return this.handleInput(),this.handleCatalog(),this.audited(),new c.a(function(e,a){Object(d.a)(t.article).then(function(a){t.recommendArticle(),t.$message({message:a.data.message,type:"success"}),t.$router.go(-1),e()}).catch(function(e){a(e),t.$message.error("不好意思，出错了哦~")})})},handleImageAdded:function(t,e,a,n){var r=new FormData;r.append("file",t),v()({url:"/upload/",method:"POST",data:r,headers:{Authorization:"bearer "+u.a.state.user.token}}).then(function(t){var r=t.data.data;e.insertEmbed(a,"image",r),n()}).catch(function(t){console.log(t)})},getCoordinate:function(t){this.article.coordinate=s()(t)},getDrawItem:function(){""!=this.article.coordinate&&(this.coordinateObject=JSON.parse(this.article.coordinate))},checkContent:function(){var t=this;Object(d.e)(this.article.contentHtml).then(function(e){t.article.contentHtml=e.data.data,t.$message({message:"校正成功，内容已替换。",type:"success"})}).catch(function(e){console.log(e),t.$message.error("校正服务出错，请稍后再试。")})}}),i()(n,"mounted",function(){var t=this;Object(h.c)(this.article.parentId).then(function(e){t.$store.commit("setPageImagePath",e.data),t.getDrawItem()}),Object(d.j)().then(function(e){e.data.data.forEach(function(e){t.catalogOptions.push(e)})})}),n),w=(a("05uX"),a("KHd+")),k=Object(w.a)(b,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{margin:"20px",height:"600px"}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:t.inputSpan}},[a("p",{staticClass:"label"},[t._v("文章标题")])]),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("mongolian-input",{ref:"title",staticStyle:{height:"590px"},model:{value:t.article.title,callback:function(e){t.$set(t.article,"title",e)},expression:"article.title"}})],1),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("p",{staticClass:"label"},[t._v("副标题")])]),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("mongolian-input",{ref:"subTitle",staticStyle:{height:"590px"},model:{value:t.article.subTitle,callback:function(e){t.$set(t.article,"subTitle",e)},expression:"article.subTitle"}})],1),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("p",{staticClass:"label"},[t._v("作者")])]),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("mongolian-input",{ref:"author",staticStyle:{height:"590px"},model:{value:t.article.author,callback:function(e){t.$set(t.article,"author",e)},expression:"article.author"}})],1),t._v(" "),a("el-col",{attrs:{span:t.inputSpan}},[a("p",{staticClass:"label"},[t._v("正文")]),t._v(" "),a("el-button",{staticStyle:{padding:"8px"},attrs:{type:"primary",size:"mini",plain:""},on:{click:t.checkContent}},[a("svg-icon",{attrs:{"icon-class":"check"}}),a("p",{staticStyle:{"writing-mode":"vertical-lr"}},[t._v("校正")])],1)],1),t._v(" "),a("el-col",{attrs:{span:t.editorSpan}},[a("vue-editor",{staticStyle:{height:"85%","font-size":"20px"},attrs:{useCustomImageHandler:""},on:{imageAdded:t.handleImageAdded},model:{value:t.article.contentHtml,callback:function(e){t.$set(t.article,"contentHtml",e)},expression:"article.contentHtml"}})],1),t._v(" "),a("el-col",{attrs:{span:t.leafletSpan}},[a("leaflet",{attrs:{pageImagePath:this.pageImagePath,coordinate:this.article.coordinate},on:{draw:t.getCoordinate}})],1)],1),t._v(" "),a("div",[t._v("\n    文章分类:\n    "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.catalog.id,callback:function(e){t.$set(t.catalog,"id",e)},expression:"catalog.id"}},t._l(t.catalogOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-switch",{attrs:{"active-text":"审核通过","inactive-text":"未审核"},model:{value:t.verified,callback:function(e){t.verified=e},expression:"verified"}}),t._v(" "),t.verified?a("div",[t._v("\n      推荐分类:\n      "),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.recommend,callback:function(e){t.recommend=e},expression:"recommend"}},[t._l(t.recommendOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),t._v(" "),a("el-option",{directives:[{name:"show",rawName:"v-show",value:t.imagePathCount>0,expression:"imagePathCount > 0"}],key:t.recommendImage.value,attrs:{label:t.recommendImage.label,value:t.recommendImage.value}})],2)],1):t._e(),t._v(" "),a("el-button",{on:{click:t.cancelEdit}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("确 定")])],1)],1)},[],!1,null,null,null);k.options.__file="EditArticle.vue";e.default=k.exports},YEIV:function(t,e,a){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(a("SEkw"));e.default=function(t,e,a){return e in t?(0,n.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},"a4+v":function(t,e,a){"use strict";var n={name:"",props:["value"],methods:{handleInput:function(){this.$emit("input",this.$el.innerText)}}},r=(a("QmMk"),a("KHd+")),i=Object(r.a)(n,function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"edit",staticClass:"textbox",attrs:{contenteditable:"true"},domProps:{textContent:this._s(this.value)}})},[],!1,null,"b52979e6",null);i.options.__file="index.vue";e.a=i.exports},cdQt:function(t,e,a){},sMTx:function(t,e,a){"use strict";var n=a("Bqnx");a.n(n).a}}]);